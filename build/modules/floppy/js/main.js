function getCookie(e){for(var o=e+"=",t=document.cookie.split(";"),s=0;s<t.length;s++){var i=t[s].trim();if(0==i.indexOf(o))return i.substring(o.length,i.length)}return""}function setCookie(e,o,t){var s=new Date;s.setTime(s.getTime()+24*t*60*60*1e3);var i="expires="+s.toGMTString();document.cookie=e+"="+o+"; "+i}function showSplash(){currentstate=states.SplashScreen,position=180,score=rotation=velocity=0,$("#player").css({y:0,x:0}),updatePlayer($("#player")),soundSwoosh.stop(),soundSwoosh.play(),$(".pipe").remove(),pipes=new Array,$(".animated").css("animation-play-state","running"),$(".animated").css("-webkit-animation-play-state","running"),$("#splash").transition({opacity:1},2e3,"ease")}function startGame(){currentstate=states.GameScreen,$("#splash").stop(),$("#splash").transition({opacity:0},500,"ease"),setBigScore(),debugmode&&$(".boundingbox").show();loopGameloop=setInterval(gameloop,1e3/60),loopPipeloop=setInterval(updatePipes,1400),playerJump()}function updatePlayer(e){rotation=Math.min(velocity/10*90,90),$(e).css({rotate:rotation,top:position})}function gameloop(){var e=$("#player");position+=velocity+=gravity,updatePlayer(e);var o=document.getElementById("player").getBoundingClientRect(),t=34-8*Math.sin(Math.abs(rotation)/90),s=(24+o.height)/2,i=(o.width-t)/2+o.left,a=(o.height-s)/2+o.top,n=i+t,r=a+s;debugmode&&((p=$("#playerbox")).css("left",i),p.css("top",a),p.css("height",s),p.css("width",t));if(o.bottom>=$("#land").offset().top)playerDead();else{var c=$("#ceiling");if(a<=c.offset().top+c.height()&&(position=0),null!=pipes[0]){var p,l=pipes[0].children(".pipe_upper"),u=l.offset().top+l.height(),d=l.offset().left-2,h=d+pipewidth,g=u+pipeheight;if(debugmode)(p=$("#pipebox")).css("left",d),p.css("top",u),p.css("height",pipeheight),p.css("width",pipewidth);return d<n&&!(u<a&&r<g)?void playerDead():void(h<i&&(pipes.splice(0,1),playerScore()))}}}function screenClick(){currentstate==states.GameScreen?playerJump():currentstate==states.SplashScreen&&startGame()}function playerJump(){velocity=jump,soundJump.stop(),soundJump.play()}function setBigScore(e){var o=$("#bigscore");if(o.empty(),!e)for(var t=score.toString().split(""),s=0;s<t.length;s++)o.append("<img src='assets/font_big_"+t[s]+".png' alt='"+t[s]+"'>")}function setSmallScore(){var e=$("#currentscore");e.empty();for(var o=score.toString().split(""),t=0;t<o.length;t++)e.append("<img src='assets/font_small_"+o[t]+".png' alt='"+o[t]+"'>")}function setHighScore(){var e=$("#highscore");e.empty();for(var o=highscore.toString().split(""),t=0;t<o.length;t++)e.append("<img src='assets/font_small_"+o[t]+".png' alt='"+o[t]+"'>")}function setMedal(){var e=$("#medal");return e.empty(),!(score<10)&&(10<=score&&(medal="bronze"),20<=score&&(medal="silver"),30<=score&&(medal="gold"),40<=score&&(medal="platinum"),e.append('<img src="assets/medal_'+medal+'.png" alt="'+medal+'">'),!0)}function playerDead(){$(".animated").css("animation-play-state","paused"),$(".animated").css("-webkit-animation-play-state","paused");var e=$("#player").position().top+$("#player").width(),o=flyArea,t=Math.max(0,o-e);$("#player").transition({y:t+"px",rotate:90},1e3,"easeInOutCubic"),currentstate=states.ScoreScreen,clearInterval(loopGameloop),clearInterval(loopPipeloop),loopPipeloop=loopGameloop=null,isIncompatible.any()?showScore():soundHit.play().bindOnce("ended",function(){soundDie.play().bindOnce("ended",function(){showScore()})})}function showScore(){$("#scoreboard").css("display","block"),setBigScore(!0),highscore<score&&setCookie("highscore",highscore=score,999),setSmallScore(),setHighScore();var e=setMedal();soundSwoosh.stop(),soundSwoosh.play(),$("#scoreboard").css({y:"40px",opacity:0}),$("#replay").css({y:"40px",opacity:0}),$("#scoreboard").transition({y:"0px",opacity:1},600,"ease",function(){soundSwoosh.stop(),soundSwoosh.play(),$("#replay").transition({y:"0px",opacity:1},600,"ease"),e&&($("#medal").css({scale:2,opacity:0}),$("#medal").transition({opacity:1,scale:1},1200,"ease"))}),replayclickable=!0}function playerScore(){score+=1,soundScore.stop(),soundScore.play(),setBigScore()}function updatePipes(){$(".pipe").filter(function(){return $(this).position().left<=-100}).remove();var e=flyArea-pipeheight-160,o=Math.floor(Math.random()*e+80),t=$('<div class="pipe animated"><div class="pipe_upper" style="height: '+o+'px;"></div><div class="pipe_lower" style="height: '+(flyArea-pipeheight-o)+'px;"></div></div>');$("#flyarea").append(t),pipes.push(t)}var currentstate,loopGameloop,loopPipeloop,debugmode=!1,states=Object.freeze({SplashScreen:0,GameScreen:1,ScoreScreen:2}),gravity=.25,velocity=0,position=180,rotation=0,jump=-4.6,flyArea=$("#flyarea").height(),score=0,highscore=0,pipeheight=90,pipewidth=52,pipes=new Array,replayclickable=!1,volume=30,soundJump=new buzz.sound("assets/sounds/sfx_wing.ogg"),soundScore=new buzz.sound("assets/sounds/sfx_point.ogg"),soundHit=new buzz.sound("assets/sounds/sfx_hit.ogg"),soundDie=new buzz.sound("assets/sounds/sfx_die.ogg"),soundSwoosh=new buzz.sound("assets/sounds/sfx_swooshing.ogg");buzz.all().setVolume(volume),$(document).ready(function(){"?debug"==window.location.search&&(debugmode=!0),"?easy"==window.location.search&&(pipeheight=200);var e=getCookie("highscore");""!=e&&(highscore=parseInt(e)),showSplash()}),$(document).keydown(function(e){32==e.keyCode&&(currentstate==states.ScoreScreen?$("#replay").click():screenClick())}),"ontouchstart"in window?$(document).on("touchstart",screenClick):$(document).on("mousedown",screenClick),$("#replay").click(function(){replayclickable&&(replayclickable=!1,soundSwoosh.stop(),soundSwoosh.play(),$("#scoreboard").transition({y:"-40px",opacity:0},1e3,"ease",function(){$("#scoreboard").css("display","none"),showSplash()}))});var isIncompatible={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Safari:function(){return navigator.userAgent.match(/OS X.*Safari/)&&!navigator.userAgent.match(/Chrome/)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isIncompatible.Android()||isIncompatible.BlackBerry()||isIncompatible.iOS()||isIncompatible.Opera()||isIncompatible.Safari()||isIncompatible.Windows()}};"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)}).catch(function(e){console.log("ServiceWorker registration failed: ",e)});